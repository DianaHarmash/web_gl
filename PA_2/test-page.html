<!DOCTYPE html>
<html>
<head>
    <title>Sensor Data Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .data-display {
            background-color: #f5f5f5;
            padding: 20px;
            border-radius: 5px;
            margin-top: 20px;
        }
        pre {
            background-color: #eee;
            padding: 10px;
            border-radius: 3px;
            overflow-x: auto;
        }
        .value {
            font-weight: bold;
            color: #2a6496;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Sensor Data Test</h1>
        <p>This page connects to the WebSocket server and displays the latest sensor data.</p>
        
        <div class="data-display">
            <h2>Connection Status: <span id="status" class="value">Disconnected</span></h2>
            <h3>Orientation Values:</h3>
            <p>Alpha (Z-axis): <span id="alpha" class="value">0</span>° (Rotation around vertical axis)</p>
            <p>Beta (X-axis): <span id="beta" class="value">0</span>° (Front-to-back tilt)</p>
            <p>Gamma (Y-axis): <span id="gamma" class="value">0</span>° (Left-to-right tilt)</p>
            <p>Last update: <span id="timestamp" class="value">Never</span></p>
            
            <h3>Raw Data:</h3>
            <pre id="raw-data">No data received yet</pre>
        </div>
    </div>

    <script>
        // Connect to WebSocket server
        const wsUrl = 'ws://localhost:3000';
        let socket;
        
        function connect() {
            document.getElementById('status').textContent = 'Connecting...';
            
            socket = new WebSocket(wsUrl);
            
            socket.onopen = function() {
                document.getElementById('status').textContent = 'Connected';
                console.log('Connected to WebSocket server');
            };
            
            socket.onmessage = function(event) {
                try {
                    const data = JSON.parse(event.data);
                    
                    // Update the UI with the new data
                    document.getElementById('alpha').textContent = data.alpha.toFixed(2);
                    document.getElementById('beta').textContent = data.beta.toFixed(2);
                    document.getElementById('gamma').textContent = data.gamma.toFixed(2);
                    
                    const date = new Date(data.timestamp);
                    document.getElementById('timestamp').textContent = date.toLocaleTimeString();
                    
                    // Display the raw data
                    document.getElementById('raw-data').textContent = JSON.stringify(data, null, 2);
                    
                } catch (error) {
                    console.error('Error parsing message:', error);
                }
            };
            
            socket.onclose = function() {
                document.getElementById('status').textContent = 'Disconnected';
                console.log('Disconnected from WebSocket server');
                // Try to reconnect after a delay
                setTimeout(connect, 3000);
            };
            
            socket.onerror = function(error) {
                document.getElementById('status').textContent = 'Error';
                console.error('WebSocket error:', error);
            };
        }
        
        // Initial connection
        connect();
    </script>
</body>
</html>